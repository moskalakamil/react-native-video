"use strict";(self.webpackChunk_react_native_video_docs=self.webpackChunk_react_native_video_docs||[]).push([["9258"],{2580:function(e,n,a){a.r(n),a.d(n,{frontMatter:()=>s,toc:()=>r,default:()=>h,metadata:()=>t,assets:()=>l,contentTitle:()=>o});var t=JSON.parse('{"id":"extensions/caching/management","title":"Cache Management","description":"Manage, monitor, and optimize cached video content.","source":"@site/docs/extensions/caching/management.md","sourceDirName":"extensions/caching","slug":"/extensions/caching/management","permalink":"/react-native-video/docs/v7/extensions/caching/management","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Caching Strategies","permalink":"/react-native-video/docs/v7/extensions/caching/strategies"},"next":{"title":"Storage Management","permalink":"/react-native-video/docs/v7/extensions/caching/storage"}}'),c=a(74848),i=a(56151);let s={},o="Cache Management",l={},r=[{value:"Overview",id:"overview",level:2},{value:"View Cached Videos",id:"view-cached-videos",level:2},{value:"Cache Info",id:"cache-info",level:2},{value:"Clear Cache",id:"clear-cache",level:2},{value:"Clear Specific Video",id:"clear-specific-video",level:3},{value:"Clear Multiple Videos",id:"clear-multiple-videos",level:3},{value:"Clear All Cache",id:"clear-all-cache",level:3},{value:"Clear by Pattern",id:"clear-by-pattern",level:3},{value:"Storage Monitoring",id:"storage-monitoring",level:2},{value:"Get Storage Info",id:"get-storage-info",level:3},{value:"Monitor Storage Changes",id:"monitor-storage-changes",level:3},{value:"Automatic Cleanup",id:"automatic-cleanup",level:2},{value:"Age-Based Cleanup",id:"age-based-cleanup",level:3},{value:"Usage-Based Cleanup",id:"usage-based-cleanup",level:3},{value:"Size-Based Cleanup",id:"size-based-cleanup",level:3},{value:"Strategy-Based Cleanup",id:"strategy-based-cleanup",level:3},{value:"Manual Cleanup UI",id:"manual-cleanup-ui",level:2},{value:"Protected Cache",id:"protected-cache",level:2},{value:"Cache Analytics",id:"cache-analytics",level:2},{value:"Export/Import Cache",id:"exportimport-cache",level:2},{value:"Export Cache Manifest",id:"export-cache-manifest",level:3},{value:"Import Cache Manifest",id:"import-cache-manifest",level:3},{value:"Cache Events",id:"cache-events",level:2},{value:"Complete Management Example",id:"complete-management-example",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"cache-management",children:"Cache Management"})}),"\n",(0,c.jsx)(n.p,{children:"Manage, monitor, and optimize cached video content."}),"\n",(0,c.jsx)(n.admonition,{title:"Pro Feature - Coming Soon",type:"tip",children:(0,c.jsx)(n.p,{children:"Video caching is a Pro feature currently in development."})}),"\n",(0,c.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,c.jsx)(n.p,{children:"Cache management features:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"View Cached Videos"})," - List all cached content"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Clear Cache"})," - Remove cached videos"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Storage Monitoring"})," - Track cache usage"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Automatic Cleanup"})," - Remove old/unused cache"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Manual Cleanup"})," - User-controlled cleanup"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"view-cached-videos",children:"View Cached Videos"}),"\n",(0,c.jsx)(n.p,{children:"Get all cached videos:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"import { VideoCache } from 'react-native-video';\n\nconst cachedVideos = await VideoCache.getAllCached();\n\ncachedVideos.forEach(video => {\n  console.log('URL:', video.url);\n  console.log('Size:', video.size);\n  console.log('Percentage:', video.percentage);\n  console.log('Created:', video.createdAt);\n  console.log('Last Accessed:', video.lastAccessed);\n});\n"})}),"\n",(0,c.jsx)(n.h2,{id:"cache-info",children:"Cache Info"}),"\n",(0,c.jsx)(n.p,{children:"Get detailed info for specific video:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"const info = await VideoCache.getInfo('https://example.com/video.mp4');\n\nif (info) {\n  console.log('Cached:', info.cached);\n  console.log('Percentage:', info.percentage);\n  console.log('Size:', info.size);\n  console.log('Path:', info.localPath);\n  console.log('Created:', info.createdAt);\n  console.log('Last Accessed:', info.lastAccessed);\n  console.log('Access Count:', info.accessCount);\n}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"clear-cache",children:"Clear Cache"}),"\n",(0,c.jsx)(n.h3,{id:"clear-specific-video",children:"Clear Specific Video"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"await VideoCache.clear('https://example.com/video.mp4');\n"})}),"\n",(0,c.jsx)(n.h3,{id:"clear-multiple-videos",children:"Clear Multiple Videos"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"const urls = [\n  'https://example.com/video1.mp4',\n  'https://example.com/video2.mp4',\n  'https://example.com/video3.mp4',\n];\n\nawait VideoCache.clearMultiple(urls);\n"})}),"\n",(0,c.jsx)(n.h3,{id:"clear-all-cache",children:"Clear All Cache"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"await VideoCache.clearAll();\n"})}),"\n",(0,c.jsx)(n.h3,{id:"clear-by-pattern",children:"Clear by Pattern"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"// Clear all videos from specific domain\nawait VideoCache.clearByPattern('https://cdn.example.com/*');\n"})}),"\n",(0,c.jsx)(n.h2,{id:"storage-monitoring",children:"Storage Monitoring"}),"\n",(0,c.jsx)(n.h3,{id:"get-storage-info",children:"Get Storage Info"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"const storage = await VideoCache.getStorageInfo();\n\nconsole.log('Total Cache Size:', storage.totalSize);\nconsole.log('Used Size:', storage.usedSize);\nconsole.log('Available Size:', storage.availableSize);\nconsole.log('Usage Percentage:', storage.usagePercentage);\nconsole.log('Cached Videos Count:', storage.cachedVideos);\n"})}),"\n",(0,c.jsx)(n.h3,{id:"monitor-storage-changes",children:"Monitor Storage Changes"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"VideoCache.onStorageChange((storage) => {\n  console.log('Cache usage:', storage.usagePercentage);\n  \n  if (storage.usagePercentage > 0.9) {\n    console.warn('Cache almost full!');\n  }\n});\n"})}),"\n",(0,c.jsx)(n.h2,{id:"automatic-cleanup",children:"Automatic Cleanup"}),"\n",(0,c.jsx)(n.h3,{id:"age-based-cleanup",children:"Age-Based Cleanup"}),"\n",(0,c.jsx)(n.p,{children:"Remove videos older than specified age:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"// Clean cache older than 7 days\nawait VideoCache.clearOlderThan(7 * 24 * 60 * 60 * 1000);\n"})}),"\n",(0,c.jsx)(n.h3,{id:"usage-based-cleanup",children:"Usage-Based Cleanup"}),"\n",(0,c.jsx)(n.p,{children:"Remove least used cache:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"// Remove 10 least recently used videos\nawait VideoCache.clearLeastUsed(10);\n"})}),"\n",(0,c.jsx)(n.h3,{id:"size-based-cleanup",children:"Size-Based Cleanup"}),"\n",(0,c.jsx)(n.p,{children:"Remove cache to reach target size:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"// Reduce cache to 300 MB\nawait VideoCache.reduceCacheTo(300 * 1024 * 1024);\n"})}),"\n",(0,c.jsx)(n.h3,{id:"strategy-based-cleanup",children:"Strategy-Based Cleanup"}),"\n",(0,c.jsx)(n.p,{children:"Use cleanup strategies:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"// LRU - Least Recently Used\nawait VideoCache.cleanup('lru', { count: 5 });\n\n// LFU - Least Frequently Used\nawait VideoCache.cleanup('lfu', { count: 5 });\n\n// Size - Largest files first\nawait VideoCache.cleanup('size', { targetSize: 200 * 1024 * 1024 });\n"})}),"\n",(0,c.jsx)(n.h2,{id:"manual-cleanup-ui",children:"Manual Cleanup UI"}),"\n",(0,c.jsx)(n.p,{children:"Provide user interface for cache management:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"import React, { useState, useEffect } from 'react';\nimport { View, Text, Button, FlatList } from 'react-native';\nimport { VideoCache } from 'react-native-video';\n\nfunction CacheManagementScreen() {\n  const [cachedVideos, setCachedVideos] = useState([]);\n  const [storage, setStorage] = useState(null);\n\n  useEffect(() => {\n    loadCache();\n  }, []);\n\n  const loadCache = async () => {\n    const videos = await VideoCache.getAllCached();\n    const storageInfo = await VideoCache.getStorageInfo();\n    \n    setCachedVideos(videos);\n    setStorage(storageInfo);\n  };\n\n  const clearVideo = async (url) => {\n    await VideoCache.clear(url);\n    await loadCache();\n  };\n\n  const clearAll = async () => {\n    await VideoCache.clearAll();\n    await loadCache();\n  };\n\n  const clearOld = async () => {\n    await VideoCache.clearOlderThan(7 * 24 * 60 * 60 * 1000);\n    await loadCache();\n  };\n\n  return (\n    <View>\n      {storage && (\n        <View style={styles.storageInfo}>\n          <Text>Cache Size: {formatBytes(storage.usedSize)}</Text>\n          <Text>Usage: {(storage.usagePercentage * 100).toFixed(1)}%</Text>\n          <Text>Videos: {storage.cachedVideos}</Text>\n        </View>\n      )}\n\n      <View style={styles.actions}>\n        <Button title=\"Clear Old (7d+)\" onPress={clearOld} />\n        <Button title=\"Clear All\" onPress={clearAll} color=\"red\" />\n      </View>\n\n      <FlatList\n        data={cachedVideos}\n        renderItem={({ item }) => (\n          <View style={styles.videoItem}>\n            <View>\n              <Text numberOfLines={1}>{item.url}</Text>\n              <Text>Size: {formatBytes(item.size)}</Text>\n              <Text>Cached: {item.percentage}%</Text>\n              <Text>Accessed: {formatDate(item.lastAccessed)}</Text>\n            </View>\n            <Button title=\"Clear\" onPress={() => clearVideo(item.url)} />\n          </View>\n        )}\n      />\n    </View>\n  );\n}\n\nfunction formatBytes(bytes) {\n  if (bytes < 1024) return bytes + ' B';\n  if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';\n  return (bytes / 1024 / 1024).toFixed(1) + ' MB';\n}\n\nfunction formatDate(date) {\n  const now = new Date();\n  const diff = now - new Date(date);\n  const days = Math.floor(diff / (24 * 60 * 60 * 1000));\n  \n  if (days === 0) return 'Today';\n  if (days === 1) return 'Yesterday';\n  return `${days} days ago`;\n}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"protected-cache",children:"Protected Cache"}),"\n",(0,c.jsx)(n.p,{children:"Protect important videos from cleanup:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"// Mark as protected\nawait VideoCache.protect('https://example.com/important.mp4');\n\n// Check if protected\nconst isProtected = await VideoCache.isProtected('https://example.com/important.mp4');\n\n// Unprotect\nawait VideoCache.unprotect('https://example.com/important.mp4');\n\n// Clear all except protected\nawait VideoCache.clearAllExceptProtected();\n"})}),"\n",(0,c.jsx)(n.h2,{id:"cache-analytics",children:"Cache Analytics"}),"\n",(0,c.jsx)(n.p,{children:"Track cache performance:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"const analytics = await VideoCache.getAnalytics();\n\nconsole.log('Total Hits:', analytics.hits);\nconsole.log('Total Misses:', analytics.misses);\nconsole.log('Hit Rate:', analytics.hitRate);\nconsole.log('Total Cached:', analytics.totalCached);\nconsole.log('Total Cleared:', analytics.totalCleared);\nconsole.log('Average Cache Time:', analytics.avgCacheTime);\n"})}),"\n",(0,c.jsx)(n.h2,{id:"exportimport-cache",children:"Export/Import Cache"}),"\n",(0,c.jsx)(n.h3,{id:"export-cache-manifest",children:"Export Cache Manifest"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"const manifest = await VideoCache.exportManifest();\n\n// Save to file or cloud\nawait saveToFile('cache-manifest.json', JSON.stringify(manifest));\n"})}),"\n",(0,c.jsx)(n.h3,{id:"import-cache-manifest",children:"Import Cache Manifest"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"const manifest = await loadFromFile('cache-manifest.json');\n\nawait VideoCache.importManifest(JSON.parse(manifest), {\n  revalidate: true, // Check if videos still exist\n  recache: false, // Don't re-download\n});\n"})}),"\n",(0,c.jsx)(n.h2,{id:"cache-events",children:"Cache Events"}),"\n",(0,c.jsx)(n.p,{children:"Listen to cache events:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"// Video cached\nVideoCache.onCached((video) => {\n  console.log('Video cached:', video.url);\n});\n\n// Video removed\nVideoCache.onCleared((url) => {\n  console.log('Video cleared:', url);\n});\n\n// Cache full\nVideoCache.onCacheFull((storage) => {\n  console.warn('Cache full!', storage);\n  // Trigger cleanup\n  VideoCache.cleanup('lru', { count: 5 });\n});\n\n// Storage low\nVideoCache.onStorageLow((storage) => {\n  console.warn('Storage low!');\n});\n"})}),"\n",(0,c.jsx)(n.h2,{id:"complete-management-example",children:"Complete Management Example"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"import { VideoCache } from 'react-native-video';\n\nclass CacheManager {\n  constructor() {\n    this.setupAutoCleanup();\n    this.setupMonitoring();\n  }\n\n  setupAutoCleanup() {\n    // Daily cleanup at 3 AM\n    setInterval(() => {\n      const hour = new Date().getHours();\n      if (hour === 3) {\n        this.performCleanup();\n      }\n    }, 60 * 60 * 1000); // Check every hour\n  }\n\n  setupMonitoring() {\n    VideoCache.onStorageChange(async (storage) => {\n      // Auto-cleanup when 90% full\n      if (storage.usagePercentage > 0.9) {\n        await this.performCleanup();\n      }\n    });\n  }\n\n  async performCleanup() {\n    // 1. Remove videos older than 14 days\n    await VideoCache.clearOlderThan(14 * 24 * 60 * 60 * 1000);\n\n    // 2. If still over 80%, remove least used\n    const storage = await VideoCache.getStorageInfo();\n    if (storage.usagePercentage > 0.8) {\n      await VideoCache.clearLeastUsed(10);\n    }\n\n    // 3. Log cleanup\n    console.log('Cache cleanup completed');\n    const analytics = await VideoCache.getAnalytics();\n    console.log('Analytics:', analytics);\n  }\n\n  async getCacheReport() {\n    const videos = await VideoCache.getAllCached();\n    const storage = await VideoCache.getStorageInfo();\n    const analytics = await VideoCache.getAnalytics();\n\n    return {\n      totalVideos: videos.length,\n      totalSize: storage.usedSize,\n      usage: storage.usagePercentage,\n      hitRate: analytics.hitRate,\n      oldestVideo: videos.sort((a, b) => a.createdAt - b.createdAt)[0],\n      largestVideo: videos.sort((a, b) => b.size - a.size)[0],\n    };\n  }\n}\n\nexport default new CacheManager();\n"})}),"\n",(0,c.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Auto Cleanup"})," - Enable automatic cleanup"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Storage Monitoring"})," - Track usage regularly"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"User Control"})," - Let users manage cache"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Protected Cache"})," - Protect important content"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Analytics"})," - Track cache performance"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Age-Based Cleanup"})," - Remove old cache regularly"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/caching/getting-started",children:"Getting Started"})," - Video caching basics"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/caching/configuration",children:"Configuration"})," - Configure caching"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/caching/strategies",children:"Strategies"})," - Caching strategies"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/caching/storage",children:"Storage"})," - Storage management"]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},56151:function(e,n,a){a.d(n,{R:()=>s,x:()=>o});var t=a(96540);let c={},i=t.createContext(c);function s(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);