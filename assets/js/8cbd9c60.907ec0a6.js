"use strict";(self.webpackChunk_react_native_video_docs=self.webpackChunk_react_native_video_docs||[]).push([["1793"],{40841:function(e,n,a){a.r(n),a.d(n,{frontMatter:()=>s,toc:()=>d,default:()=>p,metadata:()=>l,assets:()=>i,contentTitle:()=>r});var l=JSON.parse('{"id":"extensions/uploading/multi-part-upload","title":"Multi-Part Upload","description":"Upload large files in chunks with automatic retry and resumability.","source":"@site/docs/extensions/uploading/multi-part-upload.md","sourceDirName":"extensions/uploading","slug":"/extensions/uploading/multi-part-upload","permalink":"/react-native-video/docs/v7/extensions/uploading/multi-part-upload","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Basic Upload","permalink":"/react-native-video/docs/v7/extensions/uploading/basic-upload"},"next":{"title":"Queue Management","permalink":"/react-native-video/docs/v7/extensions/uploading/queue-management"}}'),t=a(74848),o=a(56151);let s={},r="Multi-Part Upload",i={},d=[{value:"Overview",id:"overview",level:2},{value:"Basic Multi-Part Upload",id:"basic-multi-part-upload",level:2},{value:"Configuration",id:"configuration",level:2},{value:"chunkSize",id:"chunksize",level:3},{value:"maxParallelUploads",id:"maxparalleluploads",level:3},{value:"uploadId",id:"uploadid",level:3},{value:"Server Integration",id:"server-integration",level:2},{value:"Initiate Upload",id:"initiate-upload",level:3},{value:"Upload Chunks",id:"upload-chunks",level:3},{value:"Complete Upload",id:"complete-upload",level:3},{value:"Progress Tracking",id:"progress-tracking",level:2},{value:"Resumable Uploads",id:"resumable-uploads",level:2},{value:"Automatic Resume",id:"automatic-resume",level:3},{value:"Chunk Retry",id:"chunk-retry",level:2},{value:"Verification",id:"verification",level:2},{value:"Custom Endpoints",id:"custom-endpoints",level:2},{value:"Abort Upload",id:"abort-upload",level:2},{value:"Complete Example",id:"complete-example",level:2},{value:"Server Implementation Example",id:"server-implementation-example",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function u(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"multi-part-upload",children:"Multi-Part Upload"})}),"\n",(0,t.jsx)(n.p,{children:"Upload large files in chunks with automatic retry and resumability."}),"\n",(0,t.jsx)(n.admonition,{title:"Pro Feature",type:"tip",children:(0,t.jsx)(n.p,{children:"Multi-part uploads require a Pro license."})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"Multi-part uploads enable:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Large File Support"})," - Upload files of any size"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Resumable Uploads"})," - Resume from where it left off"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Parallel Chunks"})," - Upload multiple chunks simultaneously"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Automatic Retry"})," - Retry failed chunks individually"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Progress Tracking"})," - Track overall and per-chunk progress"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"basic-multi-part-upload",children:"Basic Multi-Part Upload"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import { VideoUploader } from 'react-native-video';\n\nconst upload = await VideoUploader.upload({\n  file: '/path/to/large-video.mp4',\n  url: 'https://api.example.com/upload',\n  multipart: true,\n  chunkSize: 5 * 1024 * 1024, // 5 MB chunks\n});\n\nawait upload.start();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"chunksize",children:"chunkSize"}),"\n",(0,t.jsx)(n.p,{children:"Size of each chunk in bytes."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const upload = await VideoUploader.upload({\n  file: '/path/to/video.mp4',\n  url: 'https://api.example.com/upload',\n  multipart: true,\n  chunkSize: 10 * 1024 * 1024, // 10 MB\n});\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Default"}),": ",(0,t.jsx)(n.code,{children:"5 * 1024 * 1024"})," (5 MB)"]}),"\n",(0,t.jsx)(n.h3,{id:"maxparalleluploads",children:"maxParallelUploads"}),"\n",(0,t.jsx)(n.p,{children:"Number of chunks to upload simultaneously."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const upload = await VideoUploader.upload({\n  file: '/path/to/video.mp4',\n  url: 'https://api.example.com/upload',\n  multipart: true,\n  maxParallelUploads: 3, // Upload 3 chunks at once\n});\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Default"}),": ",(0,t.jsx)(n.code,{children:"3"})]}),"\n",(0,t.jsx)(n.h3,{id:"uploadid",children:"uploadId"}),"\n",(0,t.jsx)(n.p,{children:"Custom upload ID for resuming uploads."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const upload = await VideoUploader.upload({\n  file: '/path/to/video.mp4',\n  url: 'https://api.example.com/upload',\n  multipart: true,\n  uploadId: 'my-unique-upload-id',\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"server-integration",children:"Server Integration"}),"\n",(0,t.jsx)(n.h3,{id:"initiate-upload",children:"Initiate Upload"}),"\n",(0,t.jsx)(n.p,{children:"The SDK first initiates the multi-part upload:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'// 1. SDK sends POST to initiate\nPOST https://api.example.com/upload/initiate\n{\n  "filename": "video.mp4",\n  "fileSize": 104857600,\n  "chunkSize": 5242880\n}\n\n// 2. Server responds with uploadId\n{\n  "uploadId": "abc123",\n  "chunkCount": 20\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"upload-chunks",children:"Upload Chunks"}),"\n",(0,t.jsx)(n.p,{children:"Each chunk is uploaded separately:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'// SDK uploads each chunk\nPUT https://api.example.com/upload/chunk\nHeaders:\n  X-Upload-Id: abc123\n  X-Chunk-Index: 0\n  X-Chunk-Count: 20\n  Content-Type: application/octet-stream\n\nBody: [chunk data]\n\n// Server responds\n{\n  "chunkIndex": 0,\n  "status": "received"\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"complete-upload",children:"Complete Upload"}),"\n",(0,t.jsx)(n.p,{children:"After all chunks are uploaded:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'// SDK sends completion request\nPOST https://api.example.com/upload/complete\n{\n  "uploadId": "abc123"\n}\n\n// Server merges chunks and responds\n{\n  "videoId": "video123",\n  "url": "https://cdn.example.com/video123.mp4"\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"progress-tracking",children:"Progress Tracking"}),"\n",(0,t.jsx)(n.p,{children:"Track overall and per-chunk progress:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const upload = await VideoUploader.upload({\n  file: '/path/to/video.mp4',\n  url: 'https://api.example.com/upload',\n  multipart: true,\n});\n\n// Overall progress\nupload.onProgress((progress) => {\n  console.log(`Overall: ${progress.percentage}%`);\n  console.log(`Chunks: ${progress.chunksUploaded} / ${progress.totalChunks}`);\n  console.log(`Speed: ${(progress.speed / 1024 / 1024).toFixed(2)} MB/s`);\n});\n\n// Per-chunk progress\nupload.onChunkProgress((chunkProgress) => {\n  console.log(`Chunk ${chunkProgress.index}: ${chunkProgress.percentage}%`);\n});\n\nawait upload.start();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"resumable-uploads",children:"Resumable Uploads"}),"\n",(0,t.jsx)(n.p,{children:"Resume uploads after interruption:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"// Start upload\nconst upload = await VideoUploader.upload({\n  file: '/path/to/video.mp4',\n  url: 'https://api.example.com/upload',\n  multipart: true,\n  uploadId: 'my-upload-123',\n});\n\n// Upload interrupted...\n\n// Later, resume with same uploadId\nconst resumed = await VideoUploader.resume('my-upload-123');\n\nawait resumed.start();\n"})}),"\n",(0,t.jsx)(n.h3,{id:"automatic-resume",children:"Automatic Resume"}),"\n",(0,t.jsx)(n.p,{children:"Enable automatic resume on app restart:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const upload = await VideoUploader.upload({\n  file: '/path/to/video.mp4',\n  url: 'https://api.example.com/upload',\n  multipart: true,\n  autoResume: true,\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"chunk-retry",children:"Chunk Retry"}),"\n",(0,t.jsx)(n.p,{children:"Failed chunks are automatically retried:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const upload = await VideoUploader.upload({\n  file: '/path/to/video.mp4',\n  url: 'https://api.example.com/upload',\n  multipart: true,\n  chunkRetryAttempts: 5,\n  chunkRetryDelay: 3000, // 3 seconds\n});\n\nupload.onChunkRetry((chunk, attempt) => {\n  console.log(`Retrying chunk ${chunk.index}, attempt ${attempt}`);\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"verification",children:"Verification"}),"\n",(0,t.jsx)(n.p,{children:"Verify chunks on server:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const upload = await VideoUploader.upload({\n  file: '/path/to/video.mp4',\n  url: 'https://api.example.com/upload',\n  multipart: true,\n  verifyChunks: true, // Server verifies each chunk\n  checksumAlgorithm: 'md5', // 'md5' or 'sha256'\n});\n"})}),"\n",(0,t.jsx)(n.p,{children:"Server should respond with checksum:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'// Server response for each chunk\n{\n  "chunkIndex": 0,\n  "status": "received",\n  "checksum": "5d41402abc4b2a76b9719d911017c592"\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"custom-endpoints",children:"Custom Endpoints"}),"\n",(0,t.jsx)(n.p,{children:"Use different endpoints for each operation:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const upload = await VideoUploader.upload({\n  file: '/path/to/video.mp4',\n  multipart: true,\n  endpoints: {\n    initiate: 'https://api.example.com/upload/init',\n    uploadChunk: 'https://api.example.com/upload/chunk',\n    complete: 'https://api.example.com/upload/finish',\n    abort: 'https://api.example.com/upload/cancel',\n  },\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"abort-upload",children:"Abort Upload"}),"\n",(0,t.jsx)(n.p,{children:"Cancel multi-part upload:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"await upload.abort(); // Notifies server to clean up chunks\n"})}),"\n",(0,t.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import React, { useState, useEffect } from 'react';\nimport { View, Text, Button, ProgressBar } from 'react-native';\nimport { VideoUploader } from 'react-native-video';\n\nfunction MultiPartUploadExample({ filePath, fileSize }) {\n  const [upload, setUpload] = useState(null);\n  const [progress, setProgress] = useState(0);\n  const [chunksProgress, setChunksProgress] = useState({});\n  const [state, setState] = useState('idle');\n\n  const startUpload = async () => {\n    const ul = await VideoUploader.upload({\n      file: filePath,\n      url: 'https://api.example.com/upload',\n      multipart: true,\n      chunkSize: 5 * 1024 * 1024, // 5 MB\n      maxParallelUploads: 3,\n      autoResume: true,\n      verifyChunks: true,\n    });\n\n    ul.onProgress((prog) => {\n      setProgress(prog.percentage);\n    });\n\n    ul.onChunkProgress((chunkProg) => {\n      setChunksProgress(prev => ({\n        ...prev,\n        [chunkProg.index]: chunkProg.percentage,\n      }));\n    });\n\n    ul.onStateChange((s) => setState(s));\n\n    ul.onChunkRetry((chunk, attempt) => {\n      console.log(`Retrying chunk ${chunk.index}, attempt ${attempt}`);\n    });\n\n    ul.onComplete((response) => {\n      console.log('Upload completed!', response.data);\n    });\n\n    ul.onError((error) => {\n      console.error('Upload failed:', error);\n    });\n\n    setUpload(ul);\n    await ul.start();\n  };\n\n  return (\n    <View>\n      <Text>File Size: {(fileSize / 1024 / 1024).toFixed(2)} MB</Text>\n      <Text>State: {state}</Text>\n      <Text>Progress: {progress}%</Text>\n\n      <ProgressBar progress={progress / 100} />\n\n      {upload && (\n        <View>\n          <Text>Chunks Progress:</Text>\n          {Object.entries(chunksProgress).map(([index, prog]) => (\n            <View key={index} style={{ flexDirection: 'row' }}>\n              <Text>Chunk {index}: </Text>\n              <ProgressBar progress={prog / 100} style={{ flex: 1 }} />\n              <Text>{prog}%</Text>\n            </View>\n          ))}\n        </View>\n      )}\n\n      {state === 'idle' && (\n        <Button title=\"Start Upload\" onPress={startUpload} />\n      )}\n\n      {state === 'uploading' && upload && (\n        <Button title=\"Pause\" onPress={() => upload.pause()} />\n      )}\n\n      {state === 'paused' && upload && (\n        <Button title=\"Resume\" onPress={() => upload.resume()} />\n      )}\n\n      {state === 'uploading' && upload && (\n        <Button title=\"Abort\" onPress={() => upload.abort()} color=\"red\" />\n      )}\n    </View>\n  );\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"server-implementation-example",children:"Server Implementation Example"}),"\n",(0,t.jsx)(n.p,{children:"Basic Node.js/Express server for multi-part uploads:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Initiate upload\napp.post('/upload/initiate', (req, res) => {\n  const { filename, fileSize, chunkSize } = req.body;\n  const uploadId = generateUploadId();\n  const chunkCount = Math.ceil(fileSize / chunkSize);\n  \n  // Store upload metadata\n  uploads[uploadId] = {\n    filename,\n    fileSize,\n    chunkSize,\n    chunkCount,\n    receivedChunks: [],\n  };\n  \n  res.json({ uploadId, chunkCount });\n});\n\n// Upload chunk\napp.put('/upload/chunk', (req, res) => {\n  const uploadId = req.headers['x-upload-id'];\n  const chunkIndex = parseInt(req.headers['x-chunk-index']);\n  \n  // Save chunk to disk\n  const chunkPath = `./uploads/${uploadId}/chunk-${chunkIndex}`;\n  fs.writeFileSync(chunkPath, req.body);\n  \n  // Calculate checksum\n  const checksum = calculateMD5(req.body);\n  \n  // Track received chunk\n  uploads[uploadId].receivedChunks.push(chunkIndex);\n  \n  res.json({ chunkIndex, status: 'received', checksum });\n});\n\n// Complete upload\napp.post('/upload/complete', async (req, res) => {\n  const { uploadId } = req.body;\n  const upload = uploads[uploadId];\n  \n  // Merge all chunks\n  const outputPath = `./videos/${upload.filename}`;\n  await mergeChunks(uploadId, upload.chunkCount, outputPath);\n  \n  // Clean up chunks\n  await cleanupChunks(uploadId);\n  \n  res.json({\n    videoId: uploadId,\n    url: `https://cdn.example.com/${uploadId}.mp4`,\n  });\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Chunk Size"})," - Use 5-10 MB chunks for optimal performance"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Parallel Uploads"})," - Limit to 3-5 parallel chunks"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Verification"})," - Always verify chunks with checksums"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Auto Resume"})," - Enable for better UX"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Error Handling"})," - Implement chunk-level retry logic"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Server Cleanup"})," - Clean up orphaned chunks periodically"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/uploading/basic-upload",children:"Basic Upload"})," - Simple file uploads"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/uploading/queue-management",children:"Queue Management"})," - Handle multiple uploads"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/uploading/configuration",children:"Configuration"})," - Upload configuration"]}),"\n"]})]})}function p(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},56151:function(e,n,a){a.d(n,{R:()=>s,x:()=>r});var l=a(96540);let t={},o=l.createContext(t);function s(e){let n=l.useContext(o);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),l.createElement(o.Provider,{value:n},e.children)}}}]);