"use strict";(self.webpackChunk_react_native_video_docs=self.webpackChunk_react_native_video_docs||[]).push([["5907"],{81426:function(e,n,a){a.r(n),a.d(n,{frontMatter:()=>s,toc:()=>d,default:()=>h,metadata:()=>i,assets:()=>r,contentTitle:()=>o});var i=JSON.parse('{"id":"extensions/downloading/drm-downloads","title":"DRM Downloads","description":"Download DRM-protected content for secure offline playback.","source":"@site/docs/extensions/downloading/drm-downloads.md","sourceDirName":"extensions/downloading","slug":"/extensions/downloading/drm-downloads","permalink":"/react-native-video/docs/v7/extensions/downloading/drm-downloads","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Metadata","permalink":"/react-native-video/docs/v7/extensions/downloading/metadata"},"next":{"title":"Configuration","permalink":"/react-native-video/docs/v7/extensions/downloading/configuration"}}'),l=a(74848),t=a(56151);let s={},o="DRM Downloads",r={},d=[{value:"Overview",id:"overview",level:2},{value:"Supported DRM Systems",id:"supported-drm-systems",level:2},{value:"Basic DRM Download",id:"basic-drm-download",level:2},{value:"FairPlay (iOS)",id:"fairplay-ios",level:2},{value:"Basic FairPlay Download",id:"basic-fairplay-download",level:3},{value:"With Custom Headers",id:"with-custom-headers",level:3},{value:"License Duration",id:"license-duration",level:3},{value:"Widevine (Android)",id:"widevine-android",level:2},{value:"Basic Widevine Download",id:"basic-widevine-download",level:3},{value:"With License Challenge",id:"with-license-challenge",level:3},{value:"PlayReady (Windows)",id:"playready-windows",level:2},{value:"License Management",id:"license-management",level:2},{value:"Check License Status",id:"check-license-status",level:3},{value:"Renew License",id:"renew-license",level:3},{value:"Auto-Renewal",id:"auto-renewal",level:3},{value:"Offline Playback",id:"offline-playback",level:2},{value:"Play Downloaded DRM Content",id:"play-downloaded-drm-content",level:3},{value:"Security Features",id:"security-features",level:2},{value:"Secure Storage",id:"secure-storage",level:3},{value:"Screenshot Prevention",id:"screenshot-prevention",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"License Acquisition Errors",id:"license-acquisition-errors",level:3},{value:"License Expiration Handling",id:"license-expiration-handling",level:3},{value:"Complete Example",id:"complete-example",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function c(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"drm-downloads",children:"DRM Downloads"})}),"\n",(0,l.jsx)(n.p,{children:"Download DRM-protected content for secure offline playback."}),"\n",(0,l.jsx)(n.admonition,{title:"Pro Feature",type:"tip",children:(0,l.jsx)(n.p,{children:"DRM downloads require a Pro license."})}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(n.p,{children:"Download and play DRM-protected content offline with support for:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Widevine"})," (Android)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"FairPlay"})," (iOS)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"PlayReady"})," (Windows, Xbox)"]}),"\n",(0,l.jsx)(n.li,{children:"License persistence"}),"\n",(0,l.jsx)(n.li,{children:"Offline license renewal"}),"\n",(0,l.jsx)(n.li,{children:"Secure storage"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"supported-drm-systems",children:"Supported DRM Systems"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Platform"}),(0,l.jsx)(n.th,{children:"Widevine"}),(0,l.jsx)(n.th,{children:"FairPlay"}),(0,l.jsx)(n.th,{children:"PlayReady"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"iOS"}),(0,l.jsx)(n.td,{children:"\u274C"}),(0,l.jsx)(n.td,{children:"\u2705"}),(0,l.jsx)(n.td,{children:"\u274C"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Android"}),(0,l.jsx)(n.td,{children:"\u2705"}),(0,l.jsx)(n.td,{children:"\u274C"}),(0,l.jsx)(n.td,{children:"\u274C"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"basic-drm-download",children:"Basic DRM Download"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"import { VideoDownloader } from 'react-native-video';\n\nconst download = await VideoDownloader.download({\n  url: 'https://example.com/protected-video.mp4',\n  title: 'Protected Content',\n  drm: {\n    type: 'fairplay', // or 'widevine', 'playready'\n    licenseServer: 'https://license.example.com/acquire',\n    certificateUrl: 'https://license.example.com/cert', // FairPlay only\n  },\n});\n\nawait download.start();\n"})}),"\n",(0,l.jsx)(n.h2,{id:"fairplay-ios",children:"FairPlay (iOS)"}),"\n",(0,l.jsx)(n.h3,{id:"basic-fairplay-download",children:"Basic FairPlay Download"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloader.download({\n  url: 'https://example.com/hls/master.m3u8',\n  title: 'Protected Video',\n  type: 'hls',\n  drm: {\n    type: 'fairplay',\n    licenseServer: 'https://fps.example.com/license',\n    certificateUrl: 'https://fps.example.com/cert.cer',\n  },\n});\n"})}),"\n",(0,l.jsx)(n.h3,{id:"with-custom-headers",children:"With Custom Headers"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloader.download({\n  url: 'https://example.com/hls/master.m3u8',\n  title: 'Protected Video',\n  type: 'hls',\n  drm: {\n    type: 'fairplay',\n    licenseServer: 'https://fps.example.com/license',\n    certificateUrl: 'https://fps.example.com/cert.cer',\n    headers: {\n      'Authorization': 'Bearer token',\n      'X-Custom-Data': 'user-id-123',\n    },\n  },\n});\n"})}),"\n",(0,l.jsx)(n.h3,{id:"license-duration",children:"License Duration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloader.download({\n  url: 'https://example.com/hls/master.m3u8',\n  title: 'Protected Video',\n  type: 'hls',\n  drm: {\n    type: 'fairplay',\n    licenseServer: 'https://fps.example.com/license',\n    certificateUrl: 'https://fps.example.com/cert.cer',\n    licenseDuration: 7 * 24 * 60 * 60, // 7 days in seconds\n  },\n});\n"})}),"\n",(0,l.jsx)(n.h2,{id:"widevine-android",children:"Widevine (Android)"}),"\n",(0,l.jsx)(n.h3,{id:"basic-widevine-download",children:"Basic Widevine Download"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloader.download({\n  url: 'https://example.com/dash/manifest.mpd',\n  title: 'Protected Video',\n  type: 'dash',\n  drm: {\n    type: 'widevine',\n    licenseServer: 'https://widevine.example.com/proxy',\n  },\n});\n"})}),"\n",(0,l.jsx)(n.h3,{id:"with-license-challenge",children:"With License Challenge"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloader.download({\n  url: 'https://example.com/dash/manifest.mpd',\n  title: 'Protected Video',\n  type: 'dash',\n  drm: {\n    type: 'widevine',\n    licenseServer: 'https://widevine.example.com/proxy',\n    headers: {\n      'X-AxDRM-Message': 'license-token',\n    },\n  },\n});\n"})}),"\n",(0,l.jsx)(n.h2,{id:"playready-windows",children:"PlayReady (Windows)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloader.download({\n  url: 'https://example.com/smooth/manifest',\n  title: 'Protected Video',\n  drm: {\n    type: 'playready',\n    licenseServer: 'https://playready.example.com/license',\n    headers: {\n      'Authorization': 'Bearer token',\n    },\n  },\n});\n"})}),"\n",(0,l.jsx)(n.h2,{id:"license-management",children:"License Management"}),"\n",(0,l.jsx)(n.h3,{id:"check-license-status",children:"Check License Status"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloadManager.findById(downloadId);\n\nconst licenseStatus = await download.getLicenseStatus();\n\nconsole.log(licenseStatus);\n// {\n//   isValid: true,\n//   expirationDate: '2024-12-31T23:59:59Z',\n//   daysRemaining: 7,\n//   canRenew: true,\n// }\n"})}),"\n",(0,l.jsx)(n.h3,{id:"renew-license",children:"Renew License"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloadManager.findById(downloadId);\n\nawait download.renewLicense();\n\nconsole.log('License renewed successfully');\n"})}),"\n",(0,l.jsx)(n.h3,{id:"auto-renewal",children:"Auto-Renewal"}),"\n",(0,l.jsx)(n.p,{children:"Enable automatic license renewal before expiration:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloader.download({\n  url: 'https://example.com/protected.mp4',\n  title: 'Protected Video',\n  drm: {\n    type: 'fairplay',\n    licenseServer: 'https://fps.example.com/license',\n    certificateUrl: 'https://fps.example.com/cert.cer',\n    autoRenew: true,\n    renewBeforeDays: 2, // Renew 2 days before expiration\n  },\n});\n"})}),"\n",(0,l.jsx)(n.h2,{id:"offline-playback",children:"Offline Playback"}),"\n",(0,l.jsx)(n.h3,{id:"play-downloaded-drm-content",children:"Play Downloaded DRM Content"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloadManager.findById(downloadId);\n\n// Check license before playing\nconst licenseStatus = await download.getLicenseStatus();\n\nif (!licenseStatus.isValid) {\n  console.error('License expired');\n  // Attempt to renew\n  await download.renewLicense();\n}\n\n// Play the content\nconst player = useVideoPlayer(download.localPath, {\n  drm: download.drmConfig,\n});\n\nreturn <VideoView player={player} />;\n"})}),"\n",(0,l.jsx)(n.h2,{id:"security-features",children:"Security Features"}),"\n",(0,l.jsx)(n.h3,{id:"secure-storage",children:"Secure Storage"}),"\n",(0,l.jsx)(n.p,{children:"DRM downloads are automatically stored in secure, encrypted storage:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloader.download({\n  url: 'https://example.com/protected.mp4',\n  title: 'Protected Video',\n  drm: {\n    type: 'widevine',\n    licenseServer: 'https://license.example.com',\n  },\n  secureStorage: true, // Default for DRM content\n});\n"})}),"\n",(0,l.jsx)(n.h3,{id:"screenshot-prevention",children:"Screenshot Prevention"}),"\n",(0,l.jsx)(n.p,{children:"Prevent screenshots during playback:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const player = useVideoPlayer(download.localPath, {\n  drm: download.drmConfig,\n  preventScreenCapture: true,\n});\n"})}),"\n",(0,l.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,l.jsx)(n.h3,{id:"license-acquisition-errors",children:"License Acquisition Errors"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const download = await VideoDownloader.download({\n  url: 'https://example.com/protected.mp4',\n  title: 'Protected Video',\n  drm: {\n    type: 'fairplay',\n    licenseServer: 'https://fps.example.com/license',\n    certificateUrl: 'https://fps.example.com/cert.cer',\n  },\n});\n\ndownload.onError((error) => {\n  if (error.code === 'DRM_LICENSE_ERROR') {\n    console.error('Failed to acquire license:', error.message);\n    // Show user-friendly error\n  } else if (error.code === 'DRM_CERTIFICATE_ERROR') {\n    console.error('Invalid certificate:', error.message);\n  }\n});\n\nawait download.start();\n"})}),"\n",(0,l.jsx)(n.h3,{id:"license-expiration-handling",children:"License Expiration Handling"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"// Listen for license expiration\ndownload.onLicenseExpiring((daysRemaining) => {\n  console.log(`License expires in ${daysRemaining} days`);\n  // Show renewal prompt to user\n});\n\ndownload.onLicenseExpired(() => {\n  console.log('License has expired');\n  // Disable playback, show renewal option\n});\n"})}),"\n",(0,l.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"import React, { useState, useEffect } from 'react';\nimport { View, Text, Button, Alert } from 'react-native';\nimport { VideoDownloader, VideoDownloadManager, useVideoPlayer } from 'react-native-video';\n\nfunction DRMDownloadExample() {\n  const [download, setDownload] = useState(null);\n  const [licenseStatus, setLicenseStatus] = useState(null);\n  const [player, setPlayer] = useState(null);\n\n  const startDownload = async () => {\n    const dl = await VideoDownloader.download({\n      url: 'https://example.com/hls/master.m3u8',\n      title: 'Protected Content',\n      type: 'hls',\n      drm: {\n        type: 'fairplay',\n        licenseServer: 'https://fps.example.com/license',\n        certificateUrl: 'https://fps.example.com/cert.cer',\n        licenseDuration: 7 * 24 * 60 * 60,\n        autoRenew: true,\n        renewBeforeDays: 1,\n      },\n    });\n\n    dl.onProgress((progress) => {\n      console.log(`Downloaded: ${progress.percentage}%`);\n    });\n\n    dl.onComplete(async () => {\n      const status = await dl.getLicenseStatus();\n      setLicenseStatus(status);\n      setDownload(dl);\n    });\n\n    dl.onError((error) => {\n      Alert.alert('Download Failed', error.message);\n    });\n\n    await dl.start();\n  };\n\n  const playVideo = () => {\n    if (!licenseStatus?.isValid) {\n      Alert.alert('License Invalid', 'Please renew the license');\n      return;\n    }\n\n    const p = useVideoPlayer(download.localPath, {\n      drm: download.drmConfig,\n      preventScreenCapture: true,\n    });\n\n    setPlayer(p);\n  };\n\n  const renewLicense = async () => {\n    try {\n      await download.renewLicense();\n      const status = await download.getLicenseStatus();\n      setLicenseStatus(status);\n      Alert.alert('Success', 'License renewed');\n    } catch (error) {\n      Alert.alert('Renewal Failed', error.message);\n    }\n  };\n\n  return (\n    <View>\n      {!download && (\n        <Button title=\"Download Protected Content\" onPress={startDownload} />\n      )}\n\n      {download && licenseStatus && (\n        <>\n          <Text>License Status: {licenseStatus.isValid ? 'Valid' : 'Expired'}</Text>\n          <Text>Days Remaining: {licenseStatus.daysRemaining}</Text>\n          \n          {licenseStatus.isValid && (\n            <Button title=\"Play\" onPress={playVideo} />\n          )}\n          \n          {licenseStatus.canRenew && (\n            <Button title=\"Renew License\" onPress={renewLicense} />\n          )}\n        </>\n      )}\n\n      {player && (\n        <VideoView player={player} style={{ width: '100%', aspectRatio: 16/9 }} />\n      )}\n    </View>\n  );\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Check License Before Download"})," - Verify user has valid entitlement"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Monitor Expiration"})," - Track license expiration dates"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Auto-Renewal"})," - Enable auto-renewal for better UX"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Error Handling"})," - Provide clear error messages for license issues"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Secure Storage"})," - Always use secure storage for DRM content"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Test on Device"})," - DRM doesn't work in simulators/emulators"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/downloading/adaptive-streaming",children:"Adaptive Streaming"})," - HLS/DASH downloads"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/downloading/configuration",children:"Configuration"})," - Download configuration"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/react-native-video/docs/v7/players/drm",children:"DRM Playback"})," - Online DRM playback"]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},56151:function(e,n,a){a.d(n,{R:()=>s,x:()=>o});var i=a(96540);let l={},t=i.createContext(l);function s(e){let n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);