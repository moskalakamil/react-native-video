"use strict";(self.webpackChunk_react_native_video_docs=self.webpackChunk_react_native_video_docs||[]).push([["8201"],{39429:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>c,toc:()=>o,default:()=>h,metadata:()=>t,assets:()=>d,contentTitle:()=>s});var t=JSON.parse('{"id":"extensions/caching/strategies","title":"Caching Strategies","description":"Smart strategies for when and how to cache videos to disk.","source":"@site/docs/extensions/caching/strategies.md","sourceDirName":"extensions/caching","slug":"/extensions/caching/strategies","permalink":"/react-native-video/docs/v7/extensions/caching/strategies","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Configuration","permalink":"/react-native-video/docs/v7/extensions/caching/configuration"},"next":{"title":"Cache Management","permalink":"/react-native-video/docs/v7/extensions/caching/management"}}'),a=i(74848),r=i(56151);let c={},s="Caching Strategies",d={},o=[{value:"Overview",id:"overview",level:2},{value:"On-Demand Caching",id:"on-demand-caching",level:2},{value:"Predictive Caching",id:"predictive-caching",level:2},{value:"Background Caching",id:"background-caching",level:2},{value:"Scheduled Caching",id:"scheduled-caching",level:2},{value:"Smart Queue",id:"smart-queue",level:2},{value:"Cache Profiles",id:"cache-profiles",level:2},{value:"Aggressive (Fast Startup)",id:"aggressive-fast-startup",level:3},{value:"Balanced (Recommended)",id:"balanced-recommended",level:3},{value:"Conservative (Storage-Saving)",id:"conservative-storage-saving",level:3},{value:"Feed Caching",id:"feed-caching",level:2},{value:"Playlist Caching",id:"playlist-caching",level:2},{value:"Conditional Caching",id:"conditional-caching",level:2},{value:"User Preferences",id:"user-preferences",level:2},{value:"Complete Example",id:"complete-example",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function l(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"caching-strategies",children:"Caching Strategies"})}),"\n",(0,a.jsx)(n.p,{children:"Smart strategies for when and how to cache videos to disk."}),"\n",(0,a.jsx)(n.admonition,{title:"Pro Feature - Coming Soon",type:"tip",children:(0,a.jsx)(n.p,{children:"Video caching is a Pro feature currently in development."})}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(n.p,{children:"Caching strategies - all data persists across app restarts:"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Strategy"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"On Demand"})}),(0,a.jsx)(n.td,{children:"Cache when user navigates to video"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Predictive"})}),(0,a.jsx)(n.td,{children:"Cache likely-to-watch videos ahead"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Background"})}),(0,a.jsx)(n.td,{children:"Cache during idle time"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Scheduled"})}),(0,a.jsx)(n.td,{children:"Cache at specific times (e.g., overnight)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Smart Queue"})}),(0,a.jsx)(n.td,{children:"Priority-based caching"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"on-demand-caching",children:"On-Demand Caching"}),"\n",(0,a.jsx)(n.p,{children:"Cache when user views or scrolls to video:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"import { VideoCache } from 'react-native-video';\n\nfunction VideoItem({ video, isVisible }) {\n  useEffect(() => {\n    if (isVisible) {\n      // User can see this video, start caching\n      VideoCache.cache({\n        url: video.url,\n        percentage: 30, // Quick cache for instant playback\n        priority: 'high',\n      });\n    }\n  }, [isVisible]);\n\n  return <VideoPlayer source={{ uri: video.url, cache: true }} />;\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"predictive-caching",children:"Predictive Caching"}),"\n",(0,a.jsx)(n.p,{children:"Cache next videos in feed:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"function VideoFeed({ videos, currentIndex }) {\n  useEffect(() => {\n    // Cache next 3 videos\n    const nextVideos = videos.slice(currentIndex + 1, currentIndex + 4);\n    \n    nextVideos.forEach((video, index) => {\n      VideoCache.cache({\n        url: video.url,\n        percentage: 50,\n        priority: index === 0 ? 'high' : 'medium', // Higher priority for next video\n      });\n    });\n  }, [currentIndex]);\n\n  // ...\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"background-caching",children:"Background Caching"}),"\n",(0,a.jsx)(n.p,{children:"Cache during idle time:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"import { AppState } from 'react-native';\nimport { VideoCache } from 'react-native-video';\n\nfunction setupBackgroundCaching() {\n  AppState.addEventListener('change', (state) => {\n    if (state === 'background') {\n      // App is backgrounded, start caching\n      VideoCache.queueForBackground(popularVideos.map(v => ({\n        url: v.url,\n        percentage: 50,\n      })));\n    }\n  });\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"scheduled-caching",children:"Scheduled Caching"}),"\n",(0,a.jsx)(n.p,{children:"Cache at specific times (e.g., overnight):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"import { VideoCache } from 'react-native-video';\n\nasync function scheduleNightlyCaching() {\n  const now = new Date();\n  const tonight = new Date();\n  tonight.setHours(2, 0, 0, 0); // 2 AM\n  \n  if (tonight < now) {\n    tonight.setDate(tonight.getDate() + 1);\n  }\n  \n  const delay = tonight - now;\n  \n  setTimeout(() => {\n    VideoCache.queueForBackground(videosToCache, {\n      requireWifi: true,\n      requireCharging: true,\n    });\n  }, delay);\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"smart-queue",children:"Smart Queue"}),"\n",(0,a.jsx)(n.p,{children:"Priority-based queue management:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"// High priority - currently viewing\nawait VideoCache.cache({\n  url: currentVideo.url,\n  percentage: 100,\n  priority: 'high',\n});\n\n// Medium priority - next in feed\nawait VideoCache.cache({\n  url: nextVideo.url,\n  percentage: 50,\n  priority: 'medium',\n});\n\n// Low priority - popular content\nawait VideoCache.cache({\n  url: popularVideo.url,\n  percentage: 30,\n  priority: 'low',\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"cache-profiles",children:"Cache Profiles"}),"\n",(0,a.jsx)(n.h3,{id:"aggressive-fast-startup",children:"Aggressive (Fast Startup)"}),"\n",(0,a.jsx)(n.p,{children:"Cache more, use more storage:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"VideoCache.configure({\n  defaultCachePercentage: 75, // Cache 75%\n  maxConcurrentCaches: 3, // Cache 3 at once\n  preloadNext: 3, // Preload 3 videos ahead\n});\n"})}),"\n",(0,a.jsx)(n.h3,{id:"balanced-recommended",children:"Balanced (Recommended)"}),"\n",(0,a.jsx)(n.p,{children:"Balance between speed and storage:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"VideoCache.configure({\n  defaultCachePercentage: 50, // Cache 50%\n  maxConcurrentCaches: 2, // Cache 2 at once\n  preloadNext: 2, // Preload 2 videos ahead\n});\n"})}),"\n",(0,a.jsx)(n.h3,{id:"conservative-storage-saving",children:"Conservative (Storage-Saving)"}),"\n",(0,a.jsx)(n.p,{children:"Minimal caching, save storage:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"VideoCache.configure({\n  defaultCachePercentage: 25, // Cache 25%\n  maxConcurrentCaches: 1, // Cache 1 at a time\n  preloadNext: 1, // Preload 1 video ahead\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"feed-caching",children:"Feed Caching"}),"\n",(0,a.jsx)(n.p,{children:"Cache videos in scrollable feed - all persisted to disk:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"import { FlatList } from 'react-native';\nimport { VideoCache } from 'react-native-video';\n\nfunction VideoFeed({ videos }) {\n  const onViewableItemsChanged = useRef(({ viewableItems }) => {\n    viewableItems.forEach((item, index) => {\n      // Cache visible video\n      VideoCache.cache({\n        url: item.item.url,\n        percentage: 50,\n        priority: 'high',\n      });\n      \n      // Preload next videos\n      const nextIndex = videos.indexOf(item.item) + 1;\n      if (nextIndex < videos.length) {\n        VideoCache.cache({\n          url: videos[nextIndex].url,\n          percentage: 30,\n          priority: 'medium',\n        });\n      }\n    });\n  });\n\n  return (\n    <FlatList\n      data={videos}\n      onViewableItemsChanged={onViewableItemsChanged.current}\n      viewabilityConfig={{ itemVisiblePercentThreshold: 50 }}\n      renderItem={({ item }) => <VideoItem video={item} />}\n    />\n  );\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"playlist-caching",children:"Playlist Caching"}),"\n",(0,a.jsx)(n.p,{children:"Cache entire playlists:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"async function cachePlaylist(playlist) {\n  for (let i = 0; i < playlist.videos.length; i++) {\n    await VideoCache.cache({\n      url: playlist.videos[i].url,\n      percentage: i === 0 ? 100 : 50, // Full cache for first video\n      priority: i === 0 ? 'high' : 'medium',\n    });\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"conditional-caching",children:"Conditional Caching"}),"\n",(0,a.jsx)(n.p,{children:"Cache based on conditions:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"async function smartPreload(video) {\n  const networkState = await VideoCache.getNetworkState();\n  const storage = await VideoCache.getStorageInfo();\n  const batteryLevel = await getBatteryLevel();\n\n  // Only cache if conditions are good\n  if (\n    networkState.type === 'wifi' &&\n    storage.availableSize > 100 * 1024 * 1024 && // 100 MB available\n    batteryLevel > 0.5 // 50% battery\n  ) {\n    await VideoCache.cache({\n      url: video.url,\n      percentage: 50,\n    });\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"user-preferences",children:"User Preferences"}),"\n",(0,a.jsx)(n.p,{children:"Respect user cache preferences:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"import AsyncStorage from '@react-native-async-storage/async-storage';\n\nasync function cacheWithUserPreference(video) {\n  const preferences = await AsyncStorage.getItem('cachePreferences');\n  const { enabled, wifiOnly, percentage } = JSON.parse(preferences);\n\n  if (!enabled) return;\n\n  const networkState = await VideoCache.getNetworkState();\n  \n  if (wifiOnly && networkState.type !== 'wifi') {\n    return; // Skip caching on cellular\n  }\n\n  await VideoCache.cache({\n    url: video.url,\n    percentage: percentage || 50,\n  });\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"import React, { useEffect, useRef } from 'react';\nimport { FlatList, View } from 'react-native';\nimport { VideoCache, VideoView, useVideoPlayer } from 'react-native-video';\n\nfunction SmartVideoFeed({ videos }) {\n  const currentIndex = useRef(0);\n\n  // Preload on mount\n  useEffect(() => {\n    preloadInitialVideos();\n  }, []);\n\n  const preloadInitialVideos = async () => {\n    // Cache first video fully\n    await VideoCache.cache({\n      url: videos[0].url,\n      percentage: 100,\n      priority: 'high',\n    });\n\n    // Preload next 2 videos partially\n    for (let i = 1; i < 3 && i < videos.length; i++) {\n      VideoCache.cache({\n        url: videos[i].url,\n        percentage: 50,\n        priority: 'medium',\n      });\n    }\n  };\n\n  const onViewableItemsChanged = useRef(({ viewableItems }) => {\n    if (viewableItems.length === 0) return;\n\n    const index = videos.findIndex(v => v.id === viewableItems[0].item.id);\n    currentIndex.current = index;\n\n    // Preload next videos\n    for (let i = index + 1; i < index + 4 && i < videos.length; i++) {\n      const distance = i - index;\n      VideoCache.cache({\n        url: videos[i].url,\n        percentage: distance === 1 ? 75 : 50, // More for immediate next\n        priority: distance === 1 ? 'high' : 'medium',\n      });\n    }\n  });\n\n  return (\n    <FlatList\n      data={videos}\n      onViewableItemsChanged={onViewableItemsChanged.current}\n      viewabilityConfig={{ itemVisiblePercentThreshold: 80 }}\n      renderItem={({ item }) => <CachedVideoItem video={item} />}\n    />\n  );\n}\n\nfunction CachedVideoItem({ video }) {\n  const player = useVideoPlayer({\n    source: {\n      uri: video.url,\n      cache: true, // Use cache if available\n    },\n  });\n\n  return (\n    <View>\n      <VideoView player={player} style={{ width: '100%', height: 400 }} />\n    </View>\n  );\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Proximity Caching"})," - Cache visible/next videos first"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Priority Queue"})," - Use priorities effectively"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Condition-Based"})," - Check network/storage/battery"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"User Preference"})," - Respect user settings"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Storage Aware"})," - Don't cache if storage is low"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Network Smart"})," - Prefer WiFi for large caches"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/caching/getting-started",children:"Getting Started"})," - Video caching basics"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/caching/configuration",children:"Configuration"})," - Configure caching"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/caching/management",children:"Cache Management"})," - Manage cached content"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"/react-native-video/docs/v7/extensions/caching/storage",children:"Storage"})," - Storage management"]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},56151:function(e,n,i){i.d(n,{R:()=>c,x:()=>s});var t=i(96540);let a={},r=t.createContext(a);function c(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);